# –¢–µ—Ö–Ω—ñ—á–Ω–∏–π –∞—É–¥–∏—Ç Buro710

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç—É**: 2025-02-07
**–¢–∏–ø –∞—É–¥–∏—Ç—É**: –ö–æ–º–ø–ª–µ–∫—Å–Ω–∏–π —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –∞—É–¥–∏—Ç
**–í–∏–∫–æ–Ω–∞–≤—Ü—ñ**: AI-–∞—É–¥–∏—Ç–æ—Ä–∏ (5 –ø—ñ–¥–∞–≥–µ–Ω—Ç—ñ–≤)

---

## üìä Executive Summary

### –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ö–∞—Ç–µ–≥–æ—Ä—ñ—è | –ó–∞–≥–∞–ª–æ–º | Blocker | High | Medium | Low |
|-----------|---------|----------|-------|---------|-----|
| **Backend & API** | 35 | 6 | 9 | 14 | 6 |
| **Database & Migrations** | 21 | 5 | 8 | 5 | 3 |
| **Frontend & UX** | 42 | 5 | 12 | 18 | 7 |
| **Security & DevOps** | 34 | 8 | 12 | 9 | 5 |
| **QA & Scenarios** | 18 –±–∞–≥—ñ–≤ + 24 edge cases + 8 —Ä–∏–∑–∏–∫—ñ–≤ | - | - | - | - |
| **–í–°–¨–û–ì–û** | **150+** | **24** | **41** | **46** | **21** |

### –¢–æ–ø-10 –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö —Ä–∏–∑–∏–∫—ñ–≤

1. üî¥ **JWT Secret –º–∞—î hardcoded fallback** - –ê—Ç–∞–∫—É—é—á—ñ –º–æ–∂—É—Ç—å –ø—ñ–¥—Ä–æ–±–ª—è—Ç–∏ —Ç–æ–∫–µ–Ω–∏
2. üî¥ **–ù–µ–º–∞—î RLS –ø–æ–ª—ñ—Ç–∏–∫** - –í–µ—Å—å –ë–î –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ –∑ service role key
3. üî¥ **CORS –¥–æ–∑–≤–æ–ª—è—î –≤—Å—ñ origins** - –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ CSRF –∞—Ç–∞–∫
4. üî¥ **–ù–µ–º–∞—î Rate Limiting** - Brute force –∞—Ç–∞–∫–∏ —Ç–∞ DoS –º–æ–∂–ª–∏–≤—ñ
5. üî¥ **–ù–µ–º–∞—î Input Validation Schema** - Invalid data —Ç–∞ potential injection attacks
6. üî¥ **Service Role Key –¥–ª—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π** - –ë–∞–π–ø–∞—Å–∏—Ç—å –≤—Å—ñ security checks
7. üî¥ **JWT —Ç–æ–∫–µ–Ω–∏ –≤ localStorage** - XSS vulnerability
8. üî¥ **–ù–µ–º–∞—î Security Headers** - Missing CSP, HSTS, etc.
9. üî¥ **Admin password –º–∞—î default value** - –ü—Ä–æ—Å—Ç–æ –≤–≥–∞–¥–∞—Ç–∏ credentials
10. üî¥ **–ù–µ–º–∞—î –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó** - –ù–µ–º–æ–∂–ª–∏–≤–æ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –ë–î –∑ –Ω—É–ª—è

---

## A. –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ –º–µ–∂—ñ –º–æ–¥—É–ª—ñ–≤

### –ö–∞—Ä—Ç–∞ –º–æ–¥—É–ª—ñ–≤

```
Frontend (React 19, TypeScript, Vite)
‚îú‚îÄ‚îÄ pages/          - –°—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–æ–¥–∞—Ç–∫—É
‚îÇ   ‚îú‚îÄ‚îÄ HomePage.tsx
‚îÇ   ‚îú‚îÄ‚îÄ ProjectPage.tsx
‚îÇ   ‚îî‚îÄ‚îÄ admin/      - –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ       ‚îú‚îÄ‚îÄ LoginPage.tsx
‚îÇ       ‚îú‚îÄ‚îÄ DashboardPage.tsx
‚îÇ       ‚îú‚îÄ‚îÄ CreateProjectPage.tsx
‚îÇ       ‚îú‚îÄ‚îÄ EditProjectPage.tsx
‚îÇ       ‚îú‚îÄ‚îÄ SettingsPage.tsx
‚îÇ       ‚îú‚îÄ‚îÄ SiteSettingsPage.tsx
‚îÇ       ‚îî‚îÄ‚îÄ ActivityLogPage.tsx
‚îÇ
‚îú‚îÄ‚îÄ components/     - React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ admin/      - –ê–¥–º—ñ–Ω-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ project/    - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ sections/   - –°–µ–∫—Ü—ñ—ó —Å—Ç–æ—Ä—ñ–Ω–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ layout/     - Layout –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ ui/         - –ë–∞–∑–æ–≤—ñ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ hooks/          - Custom hooks
‚îÇ   ‚îî‚îÄ‚îÄ useAuth.ts
‚îÇ
‚îú‚îÄ‚îÄ contexts/       - React contexts
‚îÇ   ‚îî‚îÄ‚îÄ LanguageContext.tsx
‚îÇ
‚îú‚îÄ‚îÄ services/       - Frontend API service
‚îÇ   ‚îî‚îÄ‚îÄ api.ts
‚îÇ
‚îî‚îÄ‚îÄ api/            - API client
    ‚îî‚îÄ‚îÄ client.ts

Backend (Express 5, TypeScript)
‚îú‚îÄ‚îÄ index.ts        - –ì–æ–ª–æ–≤–Ω–∏–π entry point
‚îú‚îÄ‚îÄ config/         - –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ jwt.ts      - JWT –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts - Supabase client
‚îÇ   ‚îî‚îÄ‚îÄ upload.js   - Upload –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îÇ
‚îú‚îÄ‚îÄ routes/         - API routes
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts     - Auth endpoints
‚îÇ   ‚îú‚îÄ‚îÄ portfolio.ts - Project CRUD endpoints
‚îÇ   ‚îî‚îÄ‚îÄ siteSettings.ts - Settings endpoints
‚îÇ
‚îú‚îÄ‚îÄ services/       - Business logic
‚îÇ   ‚îú‚îÄ‚îÄ projectService.ts
‚îÇ   ‚îú‚îÄ‚îÄ siteSettingsService.ts
‚îÇ   ‚îî‚îÄ‚îÄ storageService.ts
‚îÇ
‚îú‚îÄ‚îÄ middleware/     - Middleware
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts     - Auth middleware
‚îÇ   ‚îî‚îÄ‚îÄ multer.ts   - File upload middleware
‚îÇ
‚îú‚îÄ‚îÄ seed.ts         - Database seeding
‚îú‚îÄ‚îÄ migrate-projects.ts - Migration script
‚îî‚îÄ‚îÄ clear-projects.ts  - Cleanup script

Database (Supabase PostgreSQL)
‚îú‚îÄ‚îÄ projects        - Portfolio projects table
‚îú‚îÄ‚îÄ site_settings   - Site configuration (key-value)
‚îî‚îÄ‚îÄ storage/buckets/projects - Project images

Shared
‚îú‚îÄ‚îÄ types/          - TypeScript types
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îî‚îÄ‚îÄ project.ts
‚îÇ
‚îî‚îÄ‚îÄ config/         - Frontend config
    ‚îî‚îÄ‚îÄ translations.ts
```

### –ó–Ω–∞–π–¥–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

#### üî¥ Blocker (–ö—Ä–∏—Ç–∏—á–Ω—ñ)

**[ARCH-001] –ù–µ–º–∞—î Repository Pattern**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **–û–ø–∏—Å**: Services –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ø—Ä—è–º—ñ –≤–∏–∫–ª–∏–∫–∏ Supabase client, –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏ –ë–î –∞–±–æ –º–æ–∫–∞—Ç–∏ –≤ —Ç–µ—Å—Ç–∞—Ö
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/services/*.ts`
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Repository Pattern –∑ interfaces

**[ARCH-002] –ù–µ–º–∞—î Dependency Injection**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **–û–ø–∏—Å**: Services —ñ–º–ø–æ—Ä—Ç—É—é—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É, –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—Å—ñ service —ñ–º–ø–æ—Ä—Ç–∏
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ DI container –∞–±–æ manual DI

**[ARCH-003] Business Logic –≤ Routes**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **–û–ø–∏—Å**: Routes –º—ñ—Å—Ç—è—Ç—å business logic (file deletion, image upload orchestration)
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/routes/portfolio.ts:134-147`
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ business logic –≤ services

#### üü° High

**[ARCH-004] –ù–µ–º–∞—î Event System**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **–û–ø–∏—Å**: File uploads —Ç–∞ database changes –Ω–µ–º–∞—é—Ç—å event hooks
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ event emitter –¥–ª—è domain events

**[ARCH-005] –ù–µ–º–∞—î Domain Model Layer**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **–û–ø–∏—Å**: Database models –ø—Ä—è–º–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è –∑ services
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –°—Ç–≤–æ—Ä–∏—Ç–∏ domain models –∑ business logic

#### üîµ Medium

**[ARCH-006] –ù–µ–º–∞—î Configuration Management**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Medium
- **–û–ø–∏—Å**: Config —Ä–æ–∑–∫–∏–¥–∞–Ω–∏–π –º—ñ–∂ env vars —Ç–∞ hardcoded values
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑—É–≤–∞—Ç–∏ configuration –∑ schema validation

**[ARCH-007] –ù–µ–º–∞—î API Versioning**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Medium
- **–û–ø–∏—Å**: Routes –±–µ–∑ version prefix (`/api/portfolio` –∑–∞–º—ñ—Å—Ç—å `/api/v1/portfolio`)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ versioning –¥–ª—è –º–∞–π–±—É—Ç–Ω—ñ—Ö breaking changes

### Node.js Cycle Imports
–ù–µ–º–∞—î —Ü–∏–∫–ª—ñ—á–Ω–∏—Ö —ñ–º–ø–æ—Ä—Ç—ñ–≤.

### "God Files"
- `src/server/routes/portfolio.ts` - 200+ —Ä—è–¥–∫—ñ–≤ (–±–∞–≥–∞—Ç–æ business logic)
- `src/pages/admin/DashboardPage.tsx` - 280+ —Ä—è–¥–∫—ñ–≤ (–≤–µ–ª–∏–∫—ñ, –∞–ª–µ –∫–µ—Ä–æ–≤–∞–Ω—ñ)

---

## B. API —Ç–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

**[API-001] –ù–µ–º–∞—î Input Validation Schema**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security / API
- **Impact**: Invalid data, injection attacks
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—Å—ñ routes –≤ `src/server/routes/*.ts`
- **–û–ø–∏—Å**: Manual validation scattered, no schema validation library (Zod/Joi)
- **Evidence**:
```javascript
if (!title || !description) {
  return res.status(400).json({ error: 'Missing required fields' });
}
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Zod/Joi –¥–ª—è validation –Ω–∞ route boundary
- **Fix Effort**: M

**[API-002] Inconsistent Error Response Format**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: API / UX
- **Impact**: Poor UX, difficult debugging
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—Å—ñ routes
- **–û–ø–∏—Å**: Mix of `{ error: "..." }` —ñ `{ message: "..." }`, inconsistent status codes
- **Evidence**:
```javascript
// GET /portfolio/:id
res.json({ error: 'Failed to fetch projects' });

// POST /api/admin/logout
res.json({ message: 'Logged out successfully' });
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –°—Ç–≤–æ—Ä–∏—Ç–∏ standardized error middleware
- **Fix Effort**: S

**[API-003] No Pagination Limit Enforcement**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: Performance / Security
- **Impact**: DoS attacks, slow queries
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/routes/portfolio.ts:14-15`
- **–û–ø–∏—Å**: `limit` parameter –Ω–µ –º–∞—î upper bound
- **Evidence**:
```javascript
limit: limit ? parseInt(limit as string) : undefined
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Enforce maximum limit (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 100) –∑ default 10
- **Fix Effort**: S

**[API-004] Missing Request/Response Schema Documentation**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Medium
- **Area**: DevOps / DX
- **Impact**: Difficult API consumption
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—ñ–¥—Å—É—Ç–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- **–û–ø–∏—Å**: –ù–µ–º–∞—î OpenAPI/Swagger spec
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –°—Ç–≤–æ—Ä–∏—Ç–∏ OpenAPI spec –¥–ª—è –≤—Å—ñ—Ö endpoints
- **Fix Effort**: L

### –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è / –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è / –§—ñ–ª—å—Ç—Ä–∏

**–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ**:
- `page`, `limit`, `sortBy`, `sortOrder` parameters
- –§—ñ–ª—å—Ç—Ä–∏ –ø–æ `category`, `location`, `year`, `tags`
- –ü–æ—à—É–∫ –ø–æ title/description

**–ü—Ä–æ–±–ª–µ–º–∏**:
- ‚ùå No maximum limit enforcement
- ‚ùå No default values documented
- ‚ùå No cursor-based pagination –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö datasets
- ‚ùå Filter options endpoint fetches all data (slow)

### API Endpoints Summary

| Endpoint | Method | Auth | Validation | Error Handling | Issues |
|----------|---------|-------|------------|-----------------|---------|
| `/api/admin/login` | POST | No | Minimal | Generic | No rate limiting |
| `/api/admin/logout` | POST | Yes | None | Generic | Doesn't invalidate token |
| `/api/portfolio` | GET | No | Minimal | Generic | No pagination limit |
| `/api/portfolio/filters` | GET | No | None | Generic | Fetches all data |
| `/api/portfolio/:id` | GET | No | None | Returns 500 on 404 | Wrong status code |
| `/api/portfolio` | POST | Yes | Minimal | Generic | Multer errors not handled |
| `/api/portfolio/:id` | PUT | Yes | Minimal | Generic | JSON.parse not wrapped |
| `/api/portfolio/:id` | DELETE | Yes | None | Generic | No transaction support |
| `/api/settings` | GET | No | None | Generic | - |
| `/api/settings` | PUT | Yes | None | Generic | - |

---

## C. –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ç–∞ –º—ñ–≥—Ä–∞—Ü—ñ—ó

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

**[DB-001] Missing Initial Table Creation Migration**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Migration
- **Impact**: Cannot reproduce database from zero
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: Missing file (should be `001-init-projects.sql`)
- **–û–ø–∏—Å**: –ù–µ–º–∞—î SQL migration –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó `projects` —Ç–∞–±–ª–∏—Ü—ñ
- **Evidence**: –ù–µ–º–∞—î `CREATE TABLE projects` –≤ –∂–æ–¥–Ω–æ–º—É migration file
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ–≤–Ω—É initial migration –∑ —É—Å—ñ–º–∞ –∫–æ–ª–æ–Ω–∫–∞–º–∏, indexes
- **Fix Effort**: M

**[DB-002] No Row Level Security (RLS) Policies**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security
- **Impact**: security / data loss
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `projects`, `site_settings` tables
- **–û–ø–∏—Å**: –ù–µ–º–∞—î RLS policies, service role key bypasses –≤—Å–µ security checks
- **Evidence**: –ù–µ–º–∞—î `CREATE POLICY` statements –≤ migration files
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Enable RLS —Ç–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ policies –¥–ª—è public read, admin-only write
- **Fix Effort**: M

**[DB-003] Service Role Key Used for All Operations**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security
- **Impact**: security / data loss
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/config/supabase.ts:7`
- **–û–ø–∏—Å**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ `SUPABASE_SERVICE_ROLE_KEY`, —è–∫–∏–π bypasses –≤—Å—ñ security
- **Evidence**:
```javascript
const supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–≤–∞ clients - anon client –¥–ª—è public reads, service role —Ç—ñ–ª—å–∫–∏ –¥–ª—è admin operations
- **Fix Effort**: S

**[DB-004] No Cascade Delete Rules**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: Schema
- **Impact**: Orphaned records in storage
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `projects` table
- **–û–ø–∏—Å**: –ü—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ project, orphaned storage files –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è
- **Evidence**: –ù–µ–º–∞—î `ON DELETE CASCADE`
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement cascade delete –∞–±–æ triggers –¥–ª—è storage cleanup
- **Fix Effort**: S

**[DB-005] Missing Indexes on Filter Columns**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: Performance
- **Impact**: Slow queries, full table scans
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `projects` table
- **–û–ø–∏—Å**: `tags`, `location`, `year` columns –Ω–µ –º–∞—é—Ç—å indexes
- **Evidence**:
```javascript
// getFiltersOptions queries unindexed columns
supabase.from('projects').select('tags')
supabase.from('projects').select('location')
supabase.from('projects').select('year')
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ GIN index –¥–ª—è tags, B-tree indexes –¥–ª—è location, year, created_at
- **Fix Effort**: S

### Schema Analysis

#### Projects Table
- **Type**: Denormalized flat table (25+ columns)
- **Primary Key**: id (UUID)
- **Indexes**:
  - ‚úÖ `site_settings_key_idx`
  - ‚úÖ `projects_design_zones_gin`
  - ‚úÖ `project_images_gin`
  - ‚úÖ `projects_category_idx`
  - ‚úÖ `projects_category_primary_idx`
  - ‚ùå Missing: `tags_gin`, `location_idx`, `year_idx`, `created_at_idx`

- **Constraints**:
  - ‚úÖ Primary key on id
  - ‚ùå No NOT NULL –Ω–∞ required fields
  - ‚ùå No CHECK constraints –¥–ª—è format validation
  - ‚ùå No UNIQUE constraints
  - ‚ùå No foreign keys (correct –¥–ª—è standalone)

- **Issues**:
  - Too many optional columns ‚Üí NULL-heavy data
  - No validation –Ω–∞ text array fields (year format, area format)
  - JSONB columns lack structure validation
  - No business rule enforcement at database level

#### Site Settings Table
- **Structure**: Simple key-value pattern
- **Constraints**: UNIQUE on key ‚úÖ
- **Issues**:
  - No value type validation (all TEXT)
  - No categorization of settings

### Migration Analysis

**–°—Ç–∞—Ç—É—Å**: FAILED - Cannot reproduce from zero

**–ü—Ä–æ–±–ª–µ–º–∏**:
1. ‚ùå No initial migration (missing CREATE TABLE for projects)
2. ‚ùå No versioning (—Ñ–∞–π–ª–∏ –Ω–µ –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω—ñ)
3. ‚ùå No rollback scripts
4. ‚ùå No migration tracking table
5. ‚ùå Mixed language comments (English + Ukrainian)
6. ‚ö†Ô∏è Idempotency inconsistent (some use IF NOT EXISTS, some don't)

**Quick Fix** (1 –¥–µ–Ω—å):
```sql
-- 001-init.sql
CREATE TABLE IF NOT EXISTS projects (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  title TEXT NOT NULL,
  description TEXT[] NOT NULL,
  image_url TEXT,
  tags TEXT[] DEFAULT '{}',
  location TEXT,
  area TEXT,
  year TEXT,
  team TEXT[],
  architects TEXT[],
  concept_heading TEXT,
  concept_caption TEXT,
  concept_quote TEXT,
  category TEXT,
  category_primary TEXT,
  category_secondary TEXT,
  short_description TEXT,
  subtitle TEXT,
  photo_credits TEXT,
  project_images JSONB DEFAULT '[]',
  design_zones JSONB DEFAULT '[]',
  materials JSONB DEFAULT '[]',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Indexes
CREATE INDEX IF NOT EXISTS projects_created_at_idx ON projects (created_at DESC);
CREATE INDEX IF NOT EXISTS projects_tags_gin ON projects USING GIN (tags);
CREATE INDEX IF NOT EXISTS projects_location_idx ON projects (location);
CREATE INDEX IF NOT EXISTS projects_year_idx ON projects (year);
```

---

## D. –ë–µ–∑–ø–µ–∫–∞

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ

**[SEC-001] JWT Secret Has Insecure Fallback**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security
- **Impact**: –ê—Ç–∞–∫—É—é—á—ñ –º–æ–∂—É—Ç—å –ø—ñ–¥—Ä–æ–±–ª—è—Ç–∏ —Ç–æ–∫–µ–Ω–∏
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/config/jwt.ts:3`
- **Evidence**:
```javascript
const JWT_SECRET = process.env.JWT_SECRET || 'fallback-secret-key';
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Remove fallback, throw error if JWT_SECRET not provided
- **Fix Effort**: S

**[SEC-002] Admin Password Has Default Value**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security
- **Impact**: –õ–µ–≥–∫–æ –≤–≥–∞–¥–∞—Ç–∏ credentials
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/routes/auth.ts:9-10`
- **Evidence**:
```javascript
const ADMIN_EMAIL = process.env.ADMIN_EMAIL || 'admin@example.com';
const ADMIN_PASSWORD = process.env.ADMIN_PASSWORD || 'admin123';
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Remove defaults, implement first-run setup
- **Fix Effort**: S

**[SEC-003] CORS Too Permissive**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security
- **Impact**: CSRF attacks –≤—ñ–¥ –±—É–¥—å-—è–∫–æ–≥–æ domain
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/index.ts:11`
- **Evidence**:
```javascript
app.use(cors()); // No options specified
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Configure CORS –∑ specific origin whitelist
- **Fix Effort**: S

**[SEC-004] No Rate Limiting**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security / Performance
- **Impact**: Brute force —Ç–∞ DoS attacks
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/index.ts`
- **Evidence**: –ù–µ–º–∞—î rate limiting middleware
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement express-rate-limit –∑ stricter limits –Ω–∞ auth endpoints
- **Fix Effort**: S

**[SEC-005] JWT Tokens Stored in localStorage**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security
- **Impact**: XSS vulnerability
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/api/client.ts:13`, `src/pages/admin/LoginPage.tsx:35`
- **Evidence**:
```javascript
localStorage.getItem('token')
localStorage.setItem('token', token)
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement httpOnly Secure SameSite cookies
- **Fix Effort**: L

**[SEC-006] No Security Headers**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Security
- **Impact**: Missing CSP, HSTS, X-Frame-Options
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/index.ts`
- **Evidence**: –ù–µ–º–∞—î helmet middleware
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Install —Ç–∞ configure helmet middleware
- **Fix Effort**: S

**[SEC-007] No Input Validation Library**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: Security
- **Impact**: Invalid data, potential injection
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—Å—ñ routes
- **Evidence**: –ù–µ–º–∞—î validation library –≤ package.json
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement Zod/Joi –¥–ª—è schema validation
- **Fix Effort**: M

### AuthN/AuthZ Analysis

**Current Implementation**:
- ‚úÖ JWT-based authentication
- ‚úÖ Password hashing –∑ bcryptjs
- ‚úÖ Auth middleware –¥–ª—è protected routes
- ‚ùå No RBAC (role-based access control)
- ‚ùå Token stored in localStorage (vulnerable to XSS)
- ‚ùå No CSRF protection (if using cookies)
- ‚ùå No rate limiting –Ω–∞ auth endpoints

**Issues**:
1. Token expiry –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –Ω–∞ frontend proactively
2. Auth middleware –Ω–µ —Ä–æ–∑—Ä—ñ–∑–Ω—è—î invalid —Ç–∞ expired tokens
3. Logout endpoint –Ω–µ invalidates token (stateless JWT)
4. No password complexity requirements
5. No token refresh mechanism

### Secrets Management

**–ü—Ä–æ–±–ª–µ–º–∏**:
- ‚ùå Hardcoded fallbacks –¥–ª—è JWT_SECRET, ADMIN_EMAIL, ADMIN_PASSWORD
- ‚ùå No environment variable validation –Ω–∞ startup
- ‚ö†Ô∏è JWT_EXPIRES_IN hardcoded (–Ω–µ configurable)
- ‚ùå Logging –º–æ–∂–µ –≤–º–∏–∫–∞—Ç–∏ sensitive data (console.error –±–µ–∑ filtering)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**:
```javascript
// config/validation.ts
const requiredEnvVars = [
  'JWT_SECRET',
  'ADMIN_EMAIL',
  'ADMIN_PASSWORD',
  'SUPABASE_URL',
  'SUPABASE_SERVICE_ROLE_KEY'
];

requiredEnvVars.forEach(varName => {
  if (!process.env[varName]) {
    throw new Error(`Missing required environment variable: ${varName}`);
  }
});
```

### Uploads Security

**Current**:
- ‚úÖ Multer –¥–ª—è file upload
- ‚úÖ File type validation (JPEG/PNG)
- ‚úÖ File size limit (5MB)
- ‚ùå No Content-Length validation –¥–æ upload
- ‚ùå No file content validation (magic numbers)
- ‚ùå No signed URLs (–ø—É–±–ª—ñ—á–Ω–∏–π access –¥–æ –≤—Å—ñ—Ö files)
- ‚ùå Storage bucket –±–µ–∑ RLS policies

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**:
1. Add Content-Length validation middleware
2. Validate file magic numbers –Ω–µ —Ç—ñ–ª—å–∫–∏ extension
3. Implement signed URLs –∑ expirations
4. Create storage policies –¥–ª—è bucket
5. Add virus scanning –¥–ª—è production

---

## E. Frontend —è–∫—ñ—Å—Ç—å —Ç–∞ UX-—Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

**[FE-001] Missing i18n for Critical Content**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: i18n
- **Impact**: UX (–Ω–µ full localization)
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**:
  - `src/components/sections/AboutSection.tsx`
  - `src/components/sections/PhilosophySection.tsx`
  - `src/components/sections/ProcessSection.tsx`
  - `src/components/sections/ContactCTA.tsx`
  - `src/components/sections/CinematicDivider.tsx`
  - `src/components/layout/Header.tsx`
  - `src/components/layout/Footer.tsx`
  - `src/pages/admin/SiteSettingsPage.tsx`
  - `src/pages/admin/CreateProjectPage.tsx`
  - `src/pages/admin/EditProjectPage.tsx`
  - `src/components/sections/ProjectsGrid.tsx`
  - `src/components/project/ConceptSection.tsx`
- **–û–ø–∏—Å**: –ë–∞–≥–∞—Ç–æ hardcoded —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç—É –Ω–µ –≤ translations
- **Evidence**:
```tsx
<h2>–ú–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–æ—Å—Ç–æ—Ä–∏, –¥–µ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –∑ —Ç–∏—à–µ—é.</h2>
<p>Buro 710 ‚Äî —ñ–Ω—Ç–µ—Ä'—î—Ä–Ω–∞ —Å—Ç—É–¥—ñ—è...</p>
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ –≤—Å—ñ strings –¥–æ translations.ts –∑ English equivalents
- **Fix Effort**: L (–±–∞–≥–∞—Ç–æ —Ñ–∞–π–ª—ñ–≤)

**[FE-002] No Loading/Error States for Critical Operations**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: UX
- **Impact**: Poor UX, users don't know what's happening
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**:
  - `src/pages/admin/DashboardPage.tsx:58-67` (delete operation)
  - `src/pages/admin/SiteSettingsPage.tsx:34-56` (save operation)
- **Evidence**:
```tsx
const handleDelete = async (id: string) => {
  if (!confirm(t.dashboard.deleteConfirm)) return;
  try {
    await portfolioService.delete(id);
    loadProjects(); // No loading state, no success message
  } catch (error) {
    console.error('Error deleting project:', error);
  }
};
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ loading state —Ç–∞ toast notifications
- **Fix Effort**: M

**[FE-003] Missing Accessibility (a11y) Features**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: a11y
- **Impact**: WCAG 2.1 compliance issues
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**:
  - `src/components/admin/TagInput.tsx:40-45` (no aria-label)
  - `src/components/admin/ImageUpload.tsx:70-76` (no aria-label)
  - Missing skip navigation link
  - No focus management after route changes
- **Evidence**:
```tsx
<button type="button" onClick={() => handleRemoveTag(index)}>
  ‚úï
</button>
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ aria-label –¥–æ –≤—Å—ñ—Ö icon-only buttons, skip link, focus management
- **Fix Effort**: M

**[FE-004] Incomplete State Management**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: FE / UX
- **Impact**: Stale data, poor UX
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—Å—ñ pages
- **–û–ø–∏—Å**:
  - No caching layer (–∫–æ–∂–Ω–∏–π page load ‚Üí –Ω–æ–≤—ñ API calls)
  - No cache invalidation –ø—ñ—Å–ª—è admin updates
  - Inconsistent loading states
  - No optimistic updates
- **Evidence**:
```tsx
// CreateProjectPage - no cache invalidation
await portfolioService.create(formDataToSend);
navigate('/admin/dashboard'); // Stale data!
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement React Query –∞–±–æ SWR
- **Fix Effort**: L

### i18n Coverage: ~60%

**Missing Translations**:
- ‚ùå HeroSlider section content (Ukrainian hardcoded)
- ‚ùå AboutSection content (Ukrainian hardcoded)
- ‚ùå PhilosophySection values (Ukrainian hardcoded)
- ‚ùå ProcessSection steps (Ukrainian hardcoded)
- ‚ùå ContactCTA content (Ukrainian hardcoded)
- ‚ùå CinematicDivider (English hardcoded)
- ‚ùå Header navigation links (Ukrainian hardcoded)
- ‚ùå Footer copyright (Ukrainian hardcoded)
- ‚ùå SiteSettingsPage labels (Ukrainian hardcoded)
- ‚ùå Form labels in Create/EditProject (Ukrainian hardcoded)
- ‚ùå Default fallback text in ConceptSection (Ukrainian hardcoded)
- ‚ùå ProjectsGrid header (Ukrainian hardcoded)

### Accessibility Analysis

**WCAG 2.1 Compliance**: Partial (~70%)

**Keyboard Navigation**:
- ‚úÖ Basic keyboard navigation works
- ‚ùå Skip navigation link missing
- ‚ùå No focus management after route changes
- ‚ùå No focus trap –≤ mobile sidebar

**ARIA Labels and Roles**:
- ‚úÖ Links have labels (–±—ñ–ª—å—à—ñ—Å—Ç—å)
- ‚ùå Icon-only buttons missing aria-label (TagInput, ImageUpload)
- ‚ùå Dynamic content updates lack aria-live regions
- ‚ùå Status messages not announced to screen readers

**Color Contrast**:
- ‚ö†Ô∏è text-zinc-400 –º–æ–∂–µ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ 4.5:1 ratio
- ‚úÖ Primary text meets requirements
- ‚úÖ Button colors meet requirements

**Recommendations**:
1. Add skip navigation link
2. Add aria-label –¥–æ –≤—Å—ñ—Ö icon-only buttons
3. Implement aria-live regions –¥–ª—è status updates
4. Test color contrast ratios
5. Add focus management –¥–ª—è modals —ñ route changes

### State Management Assessment

**Patterns**:
- React useState –¥–ª—è component-local state
- React Context (LanguageContext) –¥–ª—è global language state
- Custom hook (useAuth) –¥–ª—è authentication state
- useEffect –¥–ª—è data fetching

**Issues**:
1. No caching - –∫–æ–∂–¥—ã–π request –¥–æ API
2. No cache invalidation - stale data –ø—ñ—Å–ª—è admin updates
3. Inconsistent loading states (–¥–µ—è–∫—ñ components –º–∞—é—Ç—å, —ñ–Ω—à—ñ –Ω—ñ)
4. No optimistic updates - slow perceived performance
5. No error boundary - no global error handling

**Quick Fix**: Implement React Query
```bash
npm install @tanstack/react-query
```

---

## F. –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

### üî¥ Performance Issues

**[PERF-001] Filter Options Fetches All Data**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: Performance
- **Impact**: Slow filter options loading
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/services/projectService.ts:104-125`
- **Evidence**:
```javascript
supabase.from('projects').select('tags')
supabase.from('projects').select('location')
supabase.from('projects').select('year')
// Three separate queries fetching ALL rows!
```
- **Impact**: Response time increases linearly –∑ project count
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Use database DISTINCT –∞–±–æ cache filter options
- **Fix Effort**: M

**[PERF-002] Missing Database Indexes**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: Performance
- **Impact**: Slow queries –Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `projects` table
- **Missing indexes**:
  - `projects_tags_gin` - –¥–ª—è filter –ø–æ tags
  - `projects_location_idx` - –¥–ª—è filter –ø–æ location
  - `projects_year_idx` - –¥–ª—è filter –ø–æ year
  - `projects_created_at_idx` - –¥–ª—è default sorting
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ indexes (–¥–∏–≤. DB section)
- **Fix Effort**: S

**[PERF-003] No Image Optimization**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Medium
- **Area**: Performance
- **Impact**: Slow page load, high bandwidth
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—Å—ñ `<img>` tags
- **Evidence**:
```tsx
<img src={project.image_url} alt={project.title} />
// No responsive sizes, no WebP, no lazy loading
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement responsive images –∑ srcset, WebP, lazy loading
- **Fix Effort**: M

**[PERF-004] No Caching**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Medium
- **Area**: Performance
- **Impact**: Unnecessary database queries
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: API endpoints
- **–û–ø–∏—Å**: –ù–µ–º–∞—î caching –¥–ª—è filter options, site settings
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement Redis –∞–±–æ in-memory cache
- **Fix Effort**: M

**[PERF-005] No Request Debouncing on Search**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Medium
- **Area**: Performance
- **Impact**: Unnecessary API requests
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: Dashboard search input
- **–û–ø–∏—Å**: –ö–æ–∂–µ–Ω keystroke ‚Üí API request
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement debounce (300ms)
- **Fix Effort**: S

**[PERF-006] No Compression**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Low
- **Area**: Performance
- **Impact**: Larger response payloads
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: Express server
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Enable gzip compression
- **Fix Effort**: S

### –õ–æ–≥–∏ —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏

**Current**:
- ‚ùå No structured logging (console.log/console.error)
- ‚ùå No request ID tracking
- ‚ùå No error tracking service (Sentry, etc.)
- ‚ùå No performance monitoring
- ‚ùå No request/response metrics

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**:
1. Implement Winston –∞–±–æ Pino –¥–ª—è structured logging
2. Add request ID middleware –¥–ª—è log correlation
3. Integrate Sentry –¥–ª—è error tracking
4. Implement Web Vitals monitoring

---

## G. DevEx / —è–∫—ñ—Å—Ç—å –∑–±—ñ—Ä–∫–∏

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

**[DEV-001] No Tests**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: Blocker
- **Area**: Code Quality
- **Impact**: No confidence in refactoring, regressions likely
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—ñ–¥—Å—É—Ç–Ω—ñ test files
- **–û–ø–∏—Å**: –ù–µ–º–∞—î unit tests, integration tests, e2e tests
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Setup Vitest + React Testing Library
- **Fix Effort**: L (–Ω–∞–ø–∏—Å–∞—Ç–∏ critical path tests)

**[DEV-002] No CI/CD**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: DevOps
- **Impact**: Manual deployment, no automated checks
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: –í—ñ–¥—Å—É—Ç–Ω—ñ GitHub Actions workflows
- **–û–ø–∏—Å**: –ù–µ–º–∞—î CI/CD pipeline
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Implement GitHub Actions –∑ build/test/deploy
- **Fix Effort**: M

**[DEV-003] Environment Variables Not Validated**
- **–°–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å**: High
- **Area**: DevOps / Security
- **Impact**: Runtime errors if env vars missing
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `src/server/config/supabase.ts:9-14`
- **Evidence**:
```javascript
if (!supabaseUrl) {
  throw new Error('SUPABASE_URL is required');
}
// Only checks on first use, not startup
```
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: Validate –≤—Å—ñ required env vars –Ω–∞ startup
- **Fix Effort**: S

### –õ—ñ–Ω—Ç–∏ / —Ñ–æ—Ä–º–∞—Ç–µ—Ä / —Ç–∏–ø–∏

**Current**:
- ‚úÖ TypeScript configured
- ‚úÖ ESLint configured
- ‚úÖ Prettier –Ω–µ—è–≤–Ω–æ (Tailwind + ESLint)
- ‚ö†Ô∏è ESLint –Ω–µ –±–ª–æ–∫—É—î PR (advisor-only)
- ‚ùå No pre-commit hooks (husky)

**Package.json scripts**:
```json
{
  "dev": "concurrently \"npm run dev:frontend\" \"npm run dev:backend\"",
  "dev:frontend": "vite",
  "dev:backend": "tsx watch src/server/index.ts",
  "build": "tsc -b && vite build",
  "lint": "eslint .",
  "preview": "vite preview",
  "seed": "tsx src/server/seed.ts"
}
```

**Issues**:
1. No `test` script
2. No `type-check` script (separate from build)
3. No `format` script
4. No `lint:fix` script
5. No `pre-commit` hook setup

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**:
```json
{
  "scripts": {
    "test": "vitest",
    "test:coverage": "vitest --coverage",
    "type-check": "tsc --noEmit",
    "format": "prettier --write \"src/**/*.{ts,tsx}\"",
    "format:check": "prettier --check \"src/**/*.{ts,tsx}\"",
    "lint": "eslint \"src/**/*.{ts,tsx}\"",
    "lint:fix": "eslint \"src/**/*.{ts,tsx}\" --fix",
    "prepare": "husky install"
  }
}
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

**Current**:
- ‚úÖ README.md (—ñ—Å–Ω—É—î)
- ‚úÖ .env.example (—ñ—Å–Ω—É—î)
- ‚ö†Ô∏è No API documentation (OpenAPI/Swagger)
- ‚ùå No architecture documentation
- ‚ùå No component documentation (Storybook)
- ‚ùå No deployment guide
- ‚ùå No troubleshooting guide

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**:
1. Generate OpenAPI spec –¥–ª—è –≤—Å—ñ—Ö endpoints
2. Create architecture diagram
3. Add component documentation (Storybook)
4. Write deployment guide (Docker, Vercel, etc.)
5. Add troubleshooting guide

---

## üöÄ Quick Wins (–º–æ–∂–Ω–∞ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞ 1 –¥–µ–Ω—å)

### Backend & API (2-3 –≥–æ–¥–∏–Ω–∏)

1. **Add CORS origin whitelist** - 15 —Ö–≤
   ```javascript
   app.use(cors({
     origin: process.env.ALLOWED_ORIGINS?.split(',') || '*',
     credentials: true
   }));
   ```

2. **Remove JWT secret fallback** - 10 —Ö–≤
   ```javascript
   const JWT_SECRET = process.env.JWT_SECRET;
   if (!JWT_SECRET) throw new Error('JWT_SECRET required');
   ```

3. **Add pagination limit enforcement** - 20 —Ö–≤
   ```javascript
   const limit = Math.min(
     parseInt(req.query.limit as string) || 10,
     100
   );
   ```

4. **Create error response middleware** - 1 –≥–æ–¥
   ```javascript
   app.use((err: Error, req, res, next) => {
     res.status(err.status || 500).json({
       error: err.message,
       code: err.code || 'INTERNAL_ERROR'
     });
   });
   ```

### Database (2 –≥–æ–¥–∏–Ω–∏)

5. **Add missing indexes** - 30 —Ö–≤
   ```sql
   CREATE INDEX projects_created_at_idx ON projects (created_at DESC);
   CREATE INDEX projects_tags_gin ON projects USING GIN (tags);
   CREATE INDEX projects_location_idx ON projects (location);
   CREATE INDEX projects_year_idx ON projects (year);
   ```

6. **Combine filter queries** - 30 —Ö–≤
   ```javascript
   // Fetch all filter data in one query
   const { data } = await supabase.from('projects').select('tags, location, year');
   ```

7. **Create initial migration** - 1 –≥–æ–¥
   ```sql
   -- See DB section for full migration script
   ```

### Security (1 –≥–æ–¥)

8. **Add security headers (helmet)** - 15 —Ö–≤
   ```bash
   npm install helmet
   ```
   ```javascript
   import helmet from 'helmet';
   app.use(helmet());
   ```

9. **Add rate limiting for login** - 30 —Ö–≤
   ```bash
   npm install express-rate-limit
   ```
   ```javascript
   import rateLimit from 'express-rate-limit';
   const loginLimiter = rateLimit({
     windowMs: 15 * 60 * 1000, // 15 min
     max: 5
   });
   app.post('/api/admin/login', loginLimiter, loginHandler);
   ```

### Frontend & UX (3-4 –≥–æ–¥–∏–Ω–∏)

10. **Move SiteSettingsPage labels to translations** - 30 —Ö–≤
11. **Fix footer copyright to use translations** - 10 —Ö–≤
12. **Fix header navigation to use translations** - 30 —Ö–≤
13. **Add success toast after project create/update** - 1 –≥–æ–¥
14. **Add aria-label to icon buttons** - 30 —Ö–≤
15. **Add loading state to delete operation** - 20 —Ö–≤
16. **Fix date formatting** - 15 —Ö–≤

### Performance (30 —Ö–≤)

17. **Implement search debounce** - 15 —Ö–≤
    ```tsx
    const debouncedSearch = useMemo(
      () => debounce(value => setFilters(prev => ({ ...prev, search: value })), 300),
      []
    );
    ```

18. **Enable gzip compression** - 15 —Ö–≤
    ```bash
    npm install compression
    ```
    ```javascript
    import compression from 'compression';
    app.use(compression());
    ```

---

## üèóÔ∏è Architecture Gaps (—Å–∏—Å—Ç–µ–º–Ω—ñ –ø–µ—Ä–µ—Ä–æ–±–∫–∏)

### 1. No Repository Pattern
**–ü—Ä–æ–±–ª–µ–º–∞**: Services –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ø—Ä—è–º—ñ –≤–∏–∫–ª–∏–∫–∏ Supabase, –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏ –ë–î –∞–±–æ –º–æ–∫–∞—Ç–∏
**–†—ñ—à–µ–Ω–Ω—è**: –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Repository Pattern –∑ interfaces
```typescript
// interface
interface IProjectRepository {
  findById(id: string): Promise<Project>;
  findAll(filters: ProjectFilters): Promise<Project[]>;
  create(data: ProjectInput): Promise<Project>;
  update(id: string, data: ProjectUpdate): Promise<Project>;
  delete(id: string): Promise<void>;
}

// implementation
class SupabaseProjectRepository implements IProjectRepository {
  // Implementation with Supabase client
}
```

### 2. No Centralized State Management
**–ü—Ä–æ–±–ª–µ–º–∞**: State —Ä–æ–∑–∫–∏–¥–∞–Ω–∏–π, –Ω–µ–º–∞—î global visibility, –≤–∞–∂–∫–æ –¥–µ–±–∞–∂–∏—Ç–∏
**–†—ñ—à–µ–Ω–Ω—è**: Implement React Query –∞–±–æ Zustand –¥–ª—è complex state

### 3. No Caching Layer
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–º–∞—î caching –¥–ª—è —á–∞—Å—Ç–æ accessed data (filters, settings)
**–†—ñ—à–µ–Ω–Ω—è**: Implement Redis –∞–±–æ in-memory cache
```javascript
// Simple in-memory cache implementation
const cache = new Map<string, { value: any, expiry: number }>();

function get(key: string, ttl: number = 300000) {
  const item = cache.get(key);
  if (!item || Date.now() > item.expiry) return null;
  return item.value;
}

function set(key: string, value: any, ttl: number = 300000) {
  cache.set(key, { value, expiry: Date.now() + ttl });
}
```

### 4. No Event System
**–ü—Ä–æ–±–ª–µ–º–∞**: File uploads —Ç–∞ database changes –Ω–µ –º–∞—é—Ç—å event hooks
**–†—ñ—à–µ–Ω–Ω—è**: Implement EventEmitter –¥–ª—è domain events
```typescript
import { EventEmitter } from 'events';

const eventBus = new EventEmitter();

// Subscribe
eventBus.on('project.created', (project) => {
  // Send email, update cache, etc.
});

// Emit
eventBus.emit('project.created', newProject);
```

### 5. No Migration Infrastructure
**–ü—Ä–æ–±–ª–µ–º–∞**: Ad-hoc SQL files –±–µ–∑ execution framework
**–†—ñ—à–µ–Ω–Ω—è**: Implement proper migration tool (node-pg-migrate, dbmate)
```bash
npm install -g dbmate
dbmate new add_indexes_to_projects
dbmate up
```

### 6. No API Versioning
**–ü—Ä–æ–±–ª–µ–º–∞**: Breaking changes –∑–ª–∞–º–∞—é—Ç—å frontend
**–†—ñ—à–µ–Ω–Ω—è**: Implement API versioning
```javascript
// v1 routes
app.use('/api/v1/portfolio', portfolioRoutesV1);

// v2 routes (future)
app.use('/api/v2/portfolio', portfolioRoutesV2);
```

### 7. No Form Library
**–ü—Ä–æ–±–ª–µ–º–∞**: Manual form state management –∑ repetitive validation logic
**–†—ñ—à–µ–Ω–Ω—è**: Implement React Hook Form –∑ Zod validation
```typescript
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';

const schema = z.object({
  title: z.string().min(1).max(100),
  description: z.string().min(1)
});

const { register, handleSubmit, formState: { errors } } = useForm({
  resolver: zodResolver(schema)
});
```

### 8. No Error Boundary
**–ü—Ä–æ–±–ª–µ–º–∞**: Errors cause white screen –∞–±–æ silent failures
**–†—ñ—à–µ–Ω–Ω—è**: Implement React Error Boundary
```tsx
class ErrorBoundary extends React.Component {
  state = { hasError: false };

  static getDerivedStateFromError(error) {
    return { hasError: true };
  }

  componentDidCatch(error, errorInfo) {
    logErrorToService(error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return <ErrorFallback />;
    }
    return this.props.children;
  }
}
```

### 9. No Input Validation Schema
**–ü—Ä–æ–±–ª–µ–º–∞**: No schema validation library, inconsistent validation
**–†—ñ—à–µ–Ω–Ω—è**: Implement Zod –¥–ª—è validation
```typescript
import { z } from 'zod';

const ProjectInputSchema = z.object({
  title: z.string().min(1).max(200),
  description: z.array(z.string().min(1)).min(1),
  location: z.string().max(100).optional(),
  year: z.string().regex(/^\d{4}$/),
  tags: z.array(z.string().max(50)).max(10)
});

// In route
const validatedData = ProjectInputSchema.parse(req.body);
```

---

## üìù Backlog

–î–∏–≤—ñ—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω–∏–π backlog —É —Ñ–∞–π–ª—ñ `docs/audit/2025-02-07-backlog.md`

---

## üîó –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –ø–∞–∫–µ—Ç–∏

```bash
# Backend
npm install helmet express-rate-limit compression
npm install zod # validation
npm install winston # logging
npm install redis # caching

# Frontend
npm install @tanstack/react-query # caching
npm install @tanstack/react-query-devtools
npm install react-hook-form # forms
npm install @hookform/resolvers # form validation adapters
npm install zod # validation
npm install react-hot-toast # notifications
npm install framer-motion # animations (already installed)

# Testing
npm install -D vitest @testing-library/react @testing-library/jest-dom
npm install -D @testing-library/user-event
npm install -D jsdom

# Code Quality
npm install -D husky lint-staged prettier
npm install -D @typescript-eslint/parser @typescript-eslint/eslint-plugin

# DevOps
npm install -D pm2 # process manager
```

### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —à–∞–±–ª–æ–Ω–∏

–î–∏–≤—ñ—Ç—å—Å—è `.tmp/audit-session/quick-fix-examples.md` –¥–ª—è –ø–æ–≤–Ω–∏—Ö –∫–æ–¥–æ–≤–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤.

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–º–∞–Ω–Ω—è

- ‚úÖ Audit Report –∑ –≤–∏—Å–Ω–æ–≤–∫–∞–º–∏ + —Ç–æ–ø-10 —Ä–∏–∑–∏–∫—ñ–≤
- ‚úÖ Backlog –∑ –∑–∞–¥–∞—á–∞–º–∏, –∫–æ–∂–Ω–∞ –º–∞—î –∫—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–º–∞–Ω–Ω—è
- ‚úÖ –ú—ñ–Ω—ñ–º—É–º 18 "Quick Wins" (–º–æ–∂–Ω–∞ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞ 1 –¥–µ–Ω—å)
- ‚úÖ –†–æ–∑–¥—ñ–ª "Architecture Gaps" (—Å–∏—Å—Ç–µ–º–Ω—ñ –ø–µ—Ä–µ—Ä–æ–±–∫–∏)

---

## üéØ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 1 (–¢–µ—Ä–º—ñ–Ω–æ–≤–æ - –ø—Ä–æ—Ç—è–≥–æ–º 1 —Ç–∏–∂–Ω—è)

1. **[SEC-001]** Remove JWT secret fallback —Ç–∞ validate env vars
2. **[SEC-002]** Remove admin credentials defaults
3. **[SEC-003]** Configure CORS –∑ origin whitelist
4. **[SEC-004]** Implement rate limiting –Ω–∞ auth endpoints
5. **[SEC-006]** Add security headers (helmet)
6. **[DB-003]** Create dual Supabase clients (anon + service role)
7. **[DB-002]** Implement RLS policies

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 2 (–í–∏—Å–æ–∫–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç - –ø—Ä–æ—Ç—è–≥–æ–º 2 —Ç–∏–∂–Ω—ñ–≤)

8. **[API-001]** Implement Zod validation –¥–ª—è –≤—Å—ñ—Ö endpoints
9. **[DB-001]** Create initial migration script
10. **[DB-005]** Add missing database indexes
11. **[PERF-001]** Optimize filter options query
12. **[FE-002]** Implement toast notification system
13. **[FE-001]** Complete i18n translation coverage

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 3 (–°–µ—Ä–µ–¥–Ω—ñ–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç - –ø—Ä–æ—Ç—è–≥–æ–º –º—ñ—Å—è—Ü—è)

14. **[FE-004]** Implement React Query –¥–ª—è caching
15. **[DEV-001]** Setup testing infrastructure (Vitest)
16. **[DEV-002]** Implement CI/CD pipeline
17. **[ARCH-001]** Implement Repository Pattern
18. **[ARCH-003]** Create error boundary
19. **[PERF-003]** Implement image optimization

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç–∏

–Ø–∫—â–æ —î –ø–∏—Ç–∞–Ω–Ω—è —â–æ–¥–æ —Ü—å–æ–≥–æ –∞—É–¥–∏—Ç—É –∞–±–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, –∑–≤–µ—Ä—Ç–∞–π—Ç–µ—Å—å –¥–æ –∫–æ–º–∞–Ω–¥–∏ —Ä–æ–∑—Ä–æ–±–∫–∏.

---

**–ó–≤—ñ—Ç –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–π**: 2025-02-07
**–í–µ—Ä—Å—ñ—è**: 1.0
**–°—Ç–∞—Ç—É—Å**: ‚úÖ Completed
